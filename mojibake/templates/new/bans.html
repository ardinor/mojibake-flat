{% extends "new/base.html" %}

{% block title %}Defestri - Break-in attempts &amp; Bans{% endblock %}

{% block content %}
<section class="bans">
    <div class="container">

        <header>
            <a href="{{ url_for('bans') }}"><h2>Break-in attempts &amp; Bans</h2></a>

        </header>

        <p>For the month of {{ last_month.strftime('%B, %Y') }}.
            <span class="pull-right">All times posted are {{ displayed_time }} {{ time_offset }}</span></p>

        <h3 style="padding-bottom: 10px;">Break-in attempts</h3>
        <table class="default">
            <thead>
                <tr>
                    <th>When</th>
                    <th>Username</th>
                    <th class="ip-column">IP</th>
                    <th>Location</th>
                </tr>
            </thead>
            <tbody>
                {% for attempt, details in breakin_attempts.iteritems() %}
                <tr class="{{ loop.cycle('odd', 'even')}}">
                    <td>{{ attempt }}</td>
                    <td>{{ details[1] }}</td>
                    <td class="ip-column">{{ details[0] }}</td>
                    <td>{{ ', '.join(ips[details[0]].values()) }}</td>
                </tr>
                {% endfor %}
                <tr class="row-total">
                    <td>Total:</td>
                    <td colspan="3">{{ breakin_attempts|length }}</td>
                </tr>
            </tbody>
        </table>

        <h3 style="padding-bottom: 10px;">Bans</h3>
        <table class="default">
            <thead>
                <tr>
                    <th>When</th>
                    <th>IP</th>
                    <th>Location</th>
                </tr>
            </thead>
            <tbody>
                {% for ban_date, ip_add in bans.iteritems() %}
                <tr class="{{ loop.cycle('odd', 'even')}}">
                    <td>{{ ban_date }}</td>
                    <td>{{ ip_add }}</td>
                    <td>{{ ', '.join(ips[ip_add].values()) }}</td>
                </tr>
                {% endfor %}
                <tr class="row-total">
                    <td>Total:</td>
                    <td colspan="2">{{ bans|length }}</td>
                </tr>
            </tbody>
        </table>

        <p><small>Automatically generated by the <a href="https://github.com/ardinor/misc/tree/master/auth-log%20parser">auth-log parser</a>.</small></p>

    </div>
</section>
{% endblock %}
